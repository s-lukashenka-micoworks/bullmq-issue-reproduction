--[[
  Function to move job from prioritized state to active.
]]

local function moveJobFromPrioritizedToActive(priorityKey, activeKey, priorityCounterKey, groupId)
  local prioritizedJob = rcall("ZPOPMIN", priorityKey)
  if #prioritizedJob > 0 then
    rcall("LPUSH", activeKey, prioritizedJob[1])
    return prioritizedJob[1]
  else
    if groupId then
      rcall("HDEL", priorityCounterKey, groupId)
    else
      rcall("DEL", priorityCounterKey)
    end
  end
end
    