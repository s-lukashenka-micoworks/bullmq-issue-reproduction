
local function increaseGroupConcurrency(groupsKey, groupId, maxConcurrency, timestamp)
  local count = rcall("HINCRBY", groupsKey .. ':active:count', groupId, 1)
  local localConcurrency = rcall("HGET", groupsKey .. ":concurrency", groupId)

  if count >= tonumber(localConcurrency or maxConcurrency) then
    rcall("ZADD", groupsKey .. ':max', timestamp, groupId)
    rcall("ZREM", groupsKey, groupId)
    return true
  end
end
